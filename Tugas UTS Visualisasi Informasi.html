<html>

<head>
    <title>Steven Wijaksana - 06311940000001</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js"
        integrity="sha512-R/QOHLpV1Ggq22vfDAWYOaMd5RopHrJNMxi8/lJu8Oihwi4Ho4BRFeiMiCefn9rasajKjnx9/fTQ/xkWnkDACg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <div>
        <canvas id="myChart"></canvas>
    </div>
    <style>
        .legendBox {
            width: 700 px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .item{
            padding: 5px 10px;
            margin: 10px;
            border-radius: 20px;
            color:black;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="legendBox">
        <button id="red_thick" onclick="toggleData(0)"class="Item"> 
               Fiction 
        </button>
        <button id="red_thin" onclick="toggleData(1)"class="Item"> 
            Non-Fiction 
     </button>
    </div>
    <script>
        const labels = [
            '2019',
            '2018',
            '2017',
            '2016',
            '2015',
            '2014',
        ];
        const books_fiction = ['Where the Crawdads Sing', 'The Wonky Donkey', 'The Handmaids Tale', 'The Girl on the Train', 'The Girl on the Train', 'Gone Girl']
        const books_nonfiction = ['Becoming', 'Becoming', 'The Subtle Art of Not Giving a F*ck: A Counterintuitive Approach to Living a Good Life', 'The 5 Love Languages: The Secret to Love that Lasts', 'The 5 Love Languages: The Secret to Love that Lasts', 'Unbroken: A World War II Story of Survival, Resilience, and Redemption']
        const Reviews_fiction = ['87841', '30183', '29442', '79446', '79446', '57271'];
        const Reviews_nonfiction = ['61133', '61133', '26490', '25554', '25554', '29673'];
        const Author_fiction = ['Delia Owens', 'Craig Smith', 'Margaret Atwood', 'Paula Hawkins', 'Paula Hawkins', 'Gillian Flynn'];
        const Author_nonfiction = ['Michelle Obama', 'Michelle Obama', 'Mark Manson', 'Gary Chapman', 'Gary Chapman', 'Laura Hillenbrand'];
        const UserRating_fiction = ['4.8', '4.8', '4.3', '4.1', '4.1', '4.0'];
        const UserRating_nonfiction = ['4.8', '4.8', '4.6', '4.8', '4.8', '4.8'];
        const Price_fiction = ['15', '4', '7', '7', '18', '9'];
        const Price_nonfiction = ['11', '11', '15', '8', '8', '16'];
        const data = {
            labels: labels,
            datasets: [{
                label: 'Fiction',
                backgroundColor: [
                    'rgb(255, 99, 132)',
                    'rgb(54, 162, 235)',
                    'rgb(255, 206, 86)',
                    'rgb(75, 192, 192)',
                    'rgb(153, 102, 255)',
                    'rgb(255, 159, 64)',
                    'rgb(245, 150, 120)'
                ],
                borderColor: [
                    'rgb(255, 99, 132)',
                    'rgb(54, 162, 235)',
                    'rgb(255, 206, 86)',
                    'rgb(75, 192, 192)',
                    'rgb(153, 102, 255)',
                    'rgb(255, 159, 64)',
                    'rgb(245, 150, 120)'
                ], // warna hijau
                data: [87841, 30183, 29442, 79446, 79446, 57271],
            },
            {
                label: 'Non Fiction',
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(245, 150, 120, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                    'rgba(245, 150, 120, 1)'
                ],
                data: [61133, 61133, 26490, 25554, 25554, 29673],
            }
            ],
        };
        const titleTooltip = (tooltipItems) => {
            return '';
        };
        const labelTooltip = (tooltipItems) => {
            return '';
        };
        const config = {
            type: 'bar',
            data: data,
            options: {
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Number of Reviews',
                            align: 'center',
                            grace:'10%', //to create bare space between title and chart in y axes
                            font: {
                                size: 15,
                            }
                        },
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Year',
                            align: 'center',
                            font: {
                                size: 15,
                            }
                        }
                    },
                },
                animations: {
                    borderWidth: {
                        duration: 1000,
                        easing: 'linear',
                        from: 7,
                        to: 1,
                        loop: true,
                    },
                    borderColor: {
                        type: 'color',
                        duration: 1000,
                        easing: 'linear',
                        from: 'rgba( 206, 250, 246 , 0.2)',
                        to: ' rgba(116, 245, 234,0.2) ',
                        loop: true,
                    }
                },
                legend: {
                    position: 'top',
                    title: {
                        display: true,
                        function(e, legendItem1, legend1) {
                            if (ci.isDatasetVisible(index1)) {
                                ci.hide(index1);
                                legendItem1.hidden = true;
                            } else {
                                ci.show(index1);
                                legendItem1.hidden = false;
                            }
                        }
                    },
                },
                responsive: true,
                plugins: {
                    legend: {
                        onClick: (evt, legendItem, legend) => {
                            const index = legend.chart.data.labels.indexOf(legendItem.text);
                            legend.chart.toggleDataVisibility(index);
                            legend.chart.getDataVisibility(index);
                            legend.chart.update();
                        },
                        position: 'right',
                        labels: {
                            generateLabels: (chart) => {
                                let visibility = [];
                                for (let i = 0; i < chart.data.labels.length; i++) {
                                    if (chart.getDataVisibility(i) === true) {
                                        visibility.push(false)
                                    } else {
                                        visibility.push(true)
                                    }
                                };
                                return chart.data.labels.map((label, index) => ({
                                    text: label,
                                    strokeStyle: chart.data.datasets[0].borderColor[index],
                                    fillStyle: chart.data.datasets[0].backgroundColor[index],
                                    hidden: visibility[index],
                                })
                                );
                            },
                        },
                    },
                    title: {
                        display: true,
                        text: 'Most-Reviewed Books on Amazon from 2014-2019 ',
                        position: 'top',
                        font: {
                            size: 21,
                        }
                    },
                    tooltip: {
                        yAlign: 'bottom',
                        displayColors: false,
                        callbacks: {
                            title: titleTooltip,
                            label: labelTooltip,
                            title: function (context) {
                                if (context[0].datasetIndex === 0) {
                                    return `Price : $ ${Price_fiction[context[0].dataIndex]}`;
                                } else {
                                    return `Price : $ ${Price_nonfiction[context[0].dataIndex]}`;
                                }
                            },
                            beforeBody: function (context) {
                                if (context[0].datasetIndex === 0) {
                                    return `Books : ${books_fiction[context[0].dataIndex]}`;
                                } else {
                                    return `Books : ${books_nonfiction[context[0].dataIndex]}`;
                                }
                            },
                            beforeLabel: function (Author) {
                                console.log(Author)
                                if (Author.datasetIndex === 0) {
                                    return `Author : ${Author_fiction[Author.dataIndex]}`;
                                } else {
                                    return `Author : ${Author_nonfiction[Author.dataIndex]}`;
                                }
                            },
                            afterLabel: function (tooltipItems) {
                                console.log(tooltipItems)
                                if (tooltipItems.datasetIndex === 0) {
                                    return `Reviews : ${Reviews_fiction[tooltipItems.dataIndex]}`;
                                } else {
                                    return `Reviews : ${Reviews_nonfiction[tooltipItems.dataIndex]}`;
                                }
                            },
                            beforeFooter: function (context) {
                                console.log(context)
                                if (context[0].datasetIndex === 0) {
                                    return `UserRating : ${UserRating_fiction[context[0].dataIndex]}`;
                                } else {
                                    return `UserRating : ${UserRating_nonfiction[context[0].dataIndex]}`;
                                }
                            },
                        }
                    },
                    subtitle: {
                        display: true,
                        text: '*Data are collected from kaggle.com',
                        font: {
                            size: '14',
                        },
                    },
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                    },
                },
            },
            plugins: [ChartDataLabels]
        };
    </script>
    <script>
        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
        document.getElementById('red_thick').style.backgroundColor= myChart.data.datasets[0].backgroundColor[0];
        document.getElementById('red_thin').style.backgroundColor= myChart.data.datasets[1].backgroundColor[0];
        document.getElementById('red_thick').style.borderColor= 'black';
        document.getElementById('red_thin').style.borderColor= 'black';
               function toggleData(value){
            const visibilityData=myChart.isDatasetVisible(value);
            if(visibilityData===true){
                myChart.hide(value);
            }
            if(visibilityData===false){
                myChart.show(value);
            }
        }
    </script>
</body>


</html>